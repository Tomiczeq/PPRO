{% extends 'navigation.html' %}

{% block title %} {{ dashboard.name }} {% endblock %}

{% block content %}
    <div class="dashboard_navbar">
        <div class="dashboard_profile">
            <span>{{ dashboard.name }}</span>
        </div>
        <div class="dashboard_btns">
            <span id="explore_btn" class="icon_btn">
                <i class="fas fa-eye"></i>
            </span>
            <span id="move_btn" class="icon_btn">
                <i class="fas fa-expand-arrows-alt"></i>
            </span>
            <span class="icon_btn" id="add_chart_btn">
                <i class="fas fa-plus"></i>
            </span>
            <span class="icon_btn" id="save_dashboard_btn">
                <i class="fas fa-save"></i>
            </span>
            <span class="icon_btn" id="dashboard_settings_btn">
                <i class="fas fa-cog"></i>
            </span>
            <span class="icon_btn" id="refresh_dashboard_btn">
                <i class="fas fa-sync"></i>
            </span>
        </div>
    </div>
{% endblock %}


{% block scripts %}
    <script>
        const dashboard_id = "{{ dashboard.id }}";

        var add_chart_btn = document.querySelector("#add_chart_btn")
        add_chart_btn.addEventListener("click", () => {
            $.ajax({
                type: "POST",
                url: "/api/createNewChart",
                data: {
                    dashboard_id: dashboard_id
                },
                success: async function (response) {
                    getDashboardCharts();
                    alert("created");
                },
                error: function (e) {
                    alert("error");
                },
            });
        })        

        async function getDashboardCharts() {
            $.ajax({
                type: "GET",
                url: "/api/getDashboardCharts",
                data: {
                    dashboard_id: dashboard_id
                },
                success: async function (response) {
                    update_charts(response);
                },
                error: function (e) {
                    alert("error");
                },
        });

        function update_charts(data) {
            console.log("lala");
            console.log(data);
        }

        }        
    </script>
{% endblock %}
